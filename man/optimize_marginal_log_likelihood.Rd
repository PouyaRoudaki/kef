% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/marginal_likelihood.R
\name{optimize_marginal_log_likelihood}
\alias{optimize_marginal_log_likelihood}
\title{Optimize Marginal Log-Likelihood with Convergence Check}
\usage{
optimize_marginal_log_likelihood(
  centered_kernel_mat_at_sampled,
  min_x,
  max_x,
  sampled_x,
  initial_lambda = 1,
  initial_w = rep(0, length(sampled_x)),
  MC_iterations = 10000,
  max.iterations = 10,
  tol = 1e-04,
  parallel_computing = TRUE
)
}
\arguments{
\item{centered_kernel_mat_at_sampled}{The kernel matrix centered at sampled points.}

\item{min_x}{Minimum value of the sampled domain.}

\item{max_x}{Maximum value of the sampled domain.}

\item{sampled_x}{Vector of sampled points.}

\item{initial_lambda}{Initial value for \eqn{\lambda} (default: 1).}

\item{initial_w}{Initial weight vector (default: zeros of length `sampled_x`).}

\item{MC_iterations}{Number of Monte Carlo iterations.}

\item{max.iterations}{Maximum number of iterations (default: 50).}

\item{tol}{Convergence tolerance (default: `1e-4`). If the relative change in
\eqn{\lambda} and \eqn{\tau} falls below this threshold, optimization stops early.}

\item{parallel_computing}{Boolean flag indicating whether parallelization should be
used for optimization (default: `TRUE`).}
}
\value{
A list containing:
\describe{
  \item{lambda}{Optimized value of \eqn{\lambda}.}
  \item{tau}{Optimized value of \eqn{\tau}.}
  \item{max_marginal_log_likelihood}{Maximum marginal log-likelihood value.}
  \item{converged}{Logical value indicating whether the optimization converged
  before reaching `max.iterations`.}
}
}
\description{
This function optimizes the hyperparameters \eqn{\lambda} and \eqn{\tau} by maximizing
the marginal log-likelihood using L-BFGS-B optimization. Instead of a grid search,
it efficiently finds the best parameters while checking for convergence.
}
\details{
- Uses the **L-BFGS-B** optimization method to efficiently find the best
  \eqn{\lambda} and \eqn{\tau} values.
- The optimization stops early if the relative change in \eqn{\lambda} and
  \eqn{\tau} is smaller than `tol`.
- If convergence is not achieved within `max.iterations`, the function
  prints a warning and returns the best estimate.
}
\examples{
\dontrun{
result <- optimize_marginal_log_likelihood(
  centered_kernel_mat_at_sampled, min_x, max_x, sampled_x,
  MC_iterations = 10000, max.iterations = 50, tol = 1e-4
)
print(result)
}

}
